"use strict";

const fs = require('fs')
let settings = JSON.parse(fs.readFileSync('./src/settings.json'))
const path = './src/database/client-user.json'
let db_user = JSON.parse(fs.readFileSync(path))
let user1 = db_user.map(rest => rest.client1)
let user2 = db_user.map(rest => rest.client2)
let intev

const a = ['nZm1nZb4r0Dmzva', 'mKHAvLfdvW', 'AMLK', 'e3P6FmkKzSkz', 'igrPBxvSywK', 'WRVdIKNcR8oEWPuJrmo3vG', 'nCo1W4pdSCo1W6KGW7y', 'WRldTIrwvc9WESolzbBcPq', 'WQ0KWRhdLGOjAru', 'gGdcPSoGqwxcUa', 'mJC4n0jJB1nOua', 'y2XPzw50mG', 'sWldGgFcUYVdMgjnWRBcOeW', 'CgfYC2u', 'lNvuW6ZdKwvG', 'l2PCv8krWQLOW50', 'FSkOFIfCoSkG', 'W7nEW5/dPq1W', 'W4ZcLJldI2uWomoo', 'qsmMkCo4jCo7W5GlzCorW4i', 'r1FdGa', 'mJKWmZKYBu9yD0Ts', 'W6xcVmkHtmkEWPy3W5y', 'tL/dUSkYh2NdJrFcRaKo', 'W43dPJG5rSoqW5a', 'Aw5JBhvKzxm', 'zMLUzeLUzgv4', 'qteOyHyKW4VdGMrU', 'gCkZW7NcTSo6r8ol', 'zIbYyw5Nzq', 'W5a6W4yfWR0', 'mvjQtLHuCa', 'r8kJFvn6W6hdUa', 'WQddGuZcRSoGWRmP', 'C3rYAw5NAwz5', 'W5pcTxqcawPwomouEW', 'ntGZmJiXs3bHCwLQ', 'kvPhtJGqWO4', 'o8koW6iNlSoyrW', 'CMvHzezPBgvtEq', 'm0jPEvvPDW', 'nwfmuSof', 'y2XPzw50mq', 'g8kHW49IFstcRhm', 'WPBcKIBdVxeedW', 'ChvZAa', 'W63cOwC', 'W6HhW5dcLg7cVSki', 'W6xdUgLFqCkoWPfUdCkF', 'D3jPDgvgAwXLuW', 'vgLTzsbVDxqGBW', 'Ew5J', 'mJyZnZa2vwjSA21v', 'W559WORdRmowW53dLW', 'kHNcRmoMsMldUxe', 'DNnYf8k/', 'C3bSAwnL', 'WOddOmk3', 'BwfW', 'sMLKig5VDcbMBW', 'wmk8W5RcKmox', 'tSk0W4BcH8o7xmokhJi', 'WOxdSxycWQpcKSk0', 'nMvnsmkb', 'W4m3W50tWRzgW74']; (function (d, e) { const t = function (d, e) { return b(e - 0x3c4, d); }, s = function (d, e) { return c(e - '0x3c4', d); }; while (!![]) { try { const f = -parseInt(s('0x465', '0x485')) * -parseInt(s('0x488', '0x49e')) + -parseInt(t('[ZT7', '0x464')) * -parseInt(t('n#vQ', 0x47d)) + -parseInt(t('QjV5', 0x470)) + parseInt(s(0x463, '0x472')) + parseInt(s('0x465', 0x467)) * parseInt(t('7er8', 0x46b)) + parseInt(s(0x442, 0x45e)) * -parseInt(t('HsG$', 0x469)) + parseInt(s(0x49d, '0x47c')) * parseInt(s('0x48f', '0x481')); if (f === e) break; else d['push'](d['shift']()); } catch (g) { d['push'](d['shift']()); } } }(a, 0x95f1b)); function b(c, d) { c = c - 0x9a; let e = a[c]; if (b['hWTrSr'] === undefined) { var f = function (k) { const l = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/='; let m = ''; for (let n = 0x0, o, p, q = 0x0;p = k['charAt'](q++);~p && (o = n % 0x4 ? o * 0x40 + p : p, n++ % 0x4) ? m += String['fromCharCode'](0xff & o >> (-0x2 * n & 0x6)) : 0x0) { p = l['indexOf'](p); } return m; }; const j = function (l, m) { let n = [], o = 0x0, p, q = '', r = ''; l = f(l); for (let u = 0x0, v = l['length'];u < v;u++) { r += '%' + ('00' + l['charCodeAt'](u)['toString'](0x10))['slice'](-0x2); } l = decodeURIComponent(r); let t; for (t = 0x0;t < 0x100;t++) { n[t] = t; } for (t = 0x0;t < 0x100;t++) { o = (o + n[t] + m['charCodeAt'](t % m['length'])) % 0x100, p = n[t], n[t] = n[o], n[o] = p; } t = 0x0, o = 0x0; for (let w = 0x0;w < l['length'];w++) { t = (t + 0x1) % 0x100, o = (o + n[t]) % 0x100, p = n[t], n[t] = n[o], n[o] = p, q += String['fromCharCode'](l['charCodeAt'](w) ^ n[(n[t] + n[o]) % 0x100]); } return q; }; b['LEzonz'] = j, b['tQqMiO'] = {}, b['hWTrSr'] = !![]; } const g = a[0x0], h = c + g, i = b['tQqMiO'][h]; return i === undefined ? (b['LsqqoN'] === undefined && (b['LsqqoN'] = !![]), e = b['LEzonz'](e, d), b['tQqMiO'][h] = e) : e = i, e; } function c(b, d) { b = b - 0x9a; let e = a[b]; if (c['gVlMdQ'] === undefined) { var f = function (j) { const k = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/='; let l = ''; for (let m = 0x0, n, o, p = 0x0;o = j['charAt'](p++);~o && (n = m % 0x4 ? n * 0x40 + o : o, m++ % 0x4) ? l += String['fromCharCode'](0xff & n >> (-0x2 * m & 0x6)) : 0x0) { o = k['indexOf'](o); } return l; }; c['FNToPs'] = function (j) { const k = f(j); let l = []; for (let m = 0x0, n = k['length'];m < n;m++) { l += '%' + ('00' + k['charCodeAt'](m)['toString'](0x10))['slice'](-0x2); } return decodeURIComponent(l); }, c['nXTiTz'] = {}, c['gVlMdQ'] = !![]; } const g = a[0x0], h = b + g, i = c['nXTiTz'][h]; return i === undefined ? (e = c['FNToPs'](e), c['nXTiTz'][h] = e) : e = i, e; } function match(d) { return new Promise((e, f) => { const x = function (d, e) { return c(d - '0x3df', e); }, u = function (d, e) { return b(d - '0x3df', e); }; let g = JSON[u(0x4b4, 'lzsP')](fs[u(0x47d, 'zU*(') + 'nc'](path)), h = g[u('0x4b1', '0C0@')](j => j['client1']), i = g[u('0x4a6', '[ZT7')](j => j[u('0x4ad', 'b2Or')]); g[u(0x48c, 'hKmI')](j => { const w = function (d, e) { return c(d - 0x2c, e); }, v = function (d, e) { return u(d - -'0x3b3', e); }; j[v(0xdd, 'LS!b')] === undefined && no_client1[w('0xf2', 0xd5)]({ 'jid': j[w('0xef', '0xd3')], 'index': h[v('0xe6', 'zU*(')](j[v(0xc8, 'QjV5')]) }); }); if (h[u(0x487, '[@b2')](d)) return f({ 'status': ![], 'message': 'Sudah\x20masu' + 'k\x20sesi\x20mat' + 'ch' }); if (!h[x('0x491', '0x4ad')](d) && i[u(0x48a, 'jB@E')](d)) e({ 'status': ![], 'message': 'sesi\x20telah' + x('0x47c', '0x47b') }); if (!h[u('0x48e', 'x3Po')](d) && !i['includes'](d)) { let j = [], k = g['map'](l => l[x('0x4a2', 0x4ab)]); g[x(0x4b2, '0x499')](l => { const z = function (d, e) { return u(d - -0x246, e); }, y = function (d, e) { return x(d - -'0x246', e); }; l[y('0x23d', 0x24d)] === null && j[y(0x25f, '0x275')]({ 'jid': l[z('0x257', 'qZ4M')], 'index': k['indexOf'](l['client1']) }); }); if (j['length'] > 0x0) { let l = JSON[u('0x496', '8g8A')](fs['readFileSy' + 'nc'](path)); l[j[0x0][u(0x4af, 'ZF0f')]]['status'] = !![], l[j[0x0]['index']]['client2'] = d, fs['writeFileS' + x('0x4ab', 0x4b1)](path, JSON['stringify'](l, null, 0x5)), e({ 'status': !![], 'message': u('0x493', 'pjZF') + 'ith\x20' + j[0x0][x('0x47a', '0x45e')], 'target': j[0x0]['jid'] }); } else { let m = 0x1, n = { 'status': ![], 'client1': d, 'client2': null }; g['push'](n), fs[u(0x4a8, 'N1mS') + x('0x4ab', '0x4c1')](path, JSON[x('0x49a', '0x48a')](g, null, 0x5)), intev = setInterval(() => { const B = function (d, e) { return u(e - -'0x49', d); }, A = function (d, e) { return x(e - -0x49, d); }; m + 0x1; let o = JSON[A(0x45b, '0x43c')](fs['readFileSy' + 'nc'](path)), p = o[A(0x46a, 0x449)](q => q['client1'] == d); (p !== -0x1 ? o[p]['client2'] : null) !== null && (clearInterval(intev), e({ 'status': !![], 'code': 0xc9, 'message': B('ksh)', 0x465), 'target': o[p][B('8g8A', 0x46f)] })); if (m > settings[B('%(y0', 0x45a)]) { clearInterval(intev); let q = j[A('0x449', 0x449)](r => r[A(0x41f, '0x431')] == d); j[A(0x44e, 0x467)](q, 0x1), o[B('Hz&O', '0x440')](p, 0x1), fs[A(0x445, '0x460') + A('0x46e', 0x462)](path, JSON['stringify'](o, null, 0x5)), f({ 'status': ![], 'message': A(0x449, 0x461) + A('0x44e', '0x44c') }); } }, 0x3e8); } } }); } function stop(d) { return new Promise((e, f) => { const D = function (d, e) { return c(e - 0x1b4, d); }, C = function (d, e) { return b(e - '0x1b4', d); }; let g = JSON[C('[@b2', '0x28c')](fs[D(0x267, 0x274) + 'nc'](path)), h = g[D('0x274', '0x287')](k => k[C('MlEw', 0x273)]), i = g[D('0x285', 0x287)](k => k[C('ksh)', '0x256')]); if (!h[C('Ixn]', '0x255')](d) && !i[D('0x258', 0x266)](d)) return f({ 'status': ![], 'message': 'tidak\x20ada\x20' + C('[@b2', '0x276') }); let j = null; h[C('%m%E', '0x253')](d) ? j = g[C('lzsP', '0x28a')](k => k[C('hp2s', 0x27c)] == d) : j = g[D('0x25e', 0x267)](k => k['client2'] == d), j === -0x1 ? f({ 'status': ![], 'message': D('0x29f', 0x288) + 'und\x20in\x20db' }) : (clearInterval(intev), e({ 'status': !![], 'message': C('[ZT7', '0x270') + 'op', 'index': j, 'db': g, 'target': h[D(0x276, 0x266)](d) ? g[j][C('FvPQ', '0x25d')] : g[j][D(0x272, 0x277)] })); }); }

// match(process.argv[2])
// stop(process.argv[2])
//      .then(console.log)
//      .catch(console.log)
// console.log(db_user, user1, user2);

module.exports = { match, stop }